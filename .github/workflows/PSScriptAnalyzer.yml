# PSScriptAnalyzer
# https://github.com/microsoft/psscriptanalyzer-action
# https://github.com/PowerShell/PSScriptAnalyzer
---
name: PSScriptAnalyzer

on:
  push:

permissions:
  contents: read

jobs:
  build:
    permissions:
      contents: read # for actions/checkout to fetch code
      security-events: write # for github/codeql-action/upload-sarif to upload SARIF results
      actions: read # only required for a private repository by github/codeql-action/upload-sarif to get the Action run status
    name: üïµÔ∏è‚Äç‚ôÇÔ∏è PSScriptAnalyzer
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: üïµÔ∏è‚Äç‚ôÇÔ∏è Run PSScriptAnalyzer
        uses: microsoft/psscriptanalyzer-action@1.1
        with:
          # The below set up runs PSScriptAnalyzer to your entire repository and runs some basic security rules.
          path: .\
          recurse: true
          # Include your own basic security rules. Removing this option will run all the rules
          includeRule: '"PSAvoidGlobalAliases", "PSAvoidUsingConvertToSecureStringWithPlainText"'
          excludeRule: '"PSAvoidLongLines"'
          output: results.sarif

      # Upload the SARIF file generated in the previous step
      - name: ‚¨ÜÔ∏è Upload SARIF results file
        uses: github/codeql-action/upload-sarif@v3
        with:
          sarif_file: results.sarif
